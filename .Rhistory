normalize <- function(x) {
(x - min(x)) / (max(x) - min(x)) * 100
}
datos_radar_norm <- as.data.frame(lapply(datos_radar, normalize))
# Agregar límites máximo y mínimo (requerido por fmsb)
datos_radar_final <- rbind(rep(100, 5), rep(0, 5), datos_radar_norm[1:4, ])
# Crear gráfico radar
radarchart(datos_radar_final,
title = "Perfil Académico por Carrera - Comparativa Multivariable",
pcol = c("#1f77b4", "#ff7f0e", "#2ca02c", "#d62728"),
plwd = 2,
plty = 1,
cglcol = "grey",
cglty = 1,
axislabcol = "grey",
vlcex = 0.8)
legend("topright",
legend = c("Computación", "Administración", "Ingeniería", "Medicina"),
bty = "n",
pch = 20,
col = c("#1f77b4", "#ff7f0e", "#2ca02c", "#d62728"))
read.csv("Sample - Superstore.csv", sep = ",")
datos <-read.csv("Sample - Superstore.csv", sep = ",")
View(datos)
summary(datos)
str(datos)
# Cargar librerías necesarias
library(dplyr)
# Cargar datos
df <- read.csv("Sample - Superstore.csv", stringsAsFactors = FALSE)
# Función para verificar valores vacíos o en blanco
check_empty_values <- function(data) {
cat("=== VALIDACIÓN DE CAMPOS VACÍOS ===\n\n")
# 1. Verificar valores NA
cat("1. VALORES NA POR COLUMNA:\n")
na_counts <- colSums(is.na(data))
na_df <- data.frame(
Columna = names(na_counts),
Valores_NA = as.numeric(na_counts),
Porcentaje_NA = round(as.numeric(na_counts) / nrow(data) * 100, 2)
)
print(na_df)
cat("\n")
# 2. Verificar cadenas vacías ""
cat("2. CADENAS VACÍAS '' POR COLUMNA:\n")
empty_string_counts <- sapply(data, function(x) sum(x == "", na.rm = TRUE))
empty_string_df <- data.frame(
Columna = names(empty_string_counts),
Cadenas_Vacias = as.numeric(empty_string_counts),
Porcentaje_Vacio = round(as.numeric(empty_string_counts) / nrow(data) * 100, 2)
)
print(empty_string_df)
cat("\n")
# 3. Verificar espacios en blanco "   "
cat("3. ESPACIOS EN BLANCO POR COLUMNA:\n")
whitespace_counts <- sapply(data, function(x) {
if(is.character(x)) {
sum(grepl("^\\s+$", x), na.rm = TRUE)
} else {
0
}
})
whitespace_df <- data.frame(
Columna = names(whitespace_counts),
Espacios_Blanco = as.numeric(whitespace_counts),
Porcentaje_Blanco = round(as.numeric(whitespace_counts) / nrow(data) * 100, 2)
)
print(whitespace_df)
cat("\n")
# 4. Resumen general
cat("4. RESUMEN GENERAL DE CAMPOS VACÍOS:\n")
total_empty <- na_counts + empty_string_counts + whitespace_counts
summary_df <- data.frame(
Columna = names(total_empty),
Total_Vacios = as.numeric(total_empty),
Porcentaje_Total = round(as.numeric(total_empty) / nrow(data) * 100, 2),
Tipo_Dato = sapply(data, class)
)
print(summary_df)
cat("\n")
# 5. Columnas con problemas
problematic_columns <- summary_df[summary_df$Total_Vacios > 0, ]
if(nrow(problematic_columns) > 0) {
cat("5. COLUMNAS CON CAMPOS VACÍOS (REQUIEREN ATENCIÓN):\n")
print(problematic_columns)
cat("\n")
} else {
cat("5. ¡NO SE ENCONTRARON CAMPOS VACÍOS EN NINGUNA COLUMNA!\n\n")
}
# 6. Estadísticas generales
cat("6. ESTADÍSTICAS GENERALES:\n")
cat("Total de filas en el dataset:", nrow(data), "\n")
cat("Total de columnas en el dataset:", ncol(data), "\n")
cat("Total de celdas vacías:", sum(total_empty), "\n")
cat("Porcentaje total de celdas vacías:",
round(sum(total_empty) / (nrow(data) * ncol(data)) * 100, 2), "%\n")
return(summary_df)
}
# Ejecutar validación
resultados <- check_empty_values(df)
# Análisis adicional por tipo de variable
cat("\n=== ANÁLISIS POR TIPO DE VARIABLE ===\n\n")
# Variables numéricas críticas
numeric_vars <- c("Sales", "Profit", "Quantity", "Discount")
cat("Variables numéricas críticas:\n")
for(var in numeric_vars) {
na_count <- sum(is.na(df[[var]]))
cat(sprintf("%-15s: %d NA (%.2f%%)\n",
var, na_count, na_count/nrow(df)*100))
}
cat("\n")
# Variables de fecha críticas
date_vars <- c("Order.Date", "Ship.Date")
cat("Variables de fecha críticas:\n")
for(var in date_vars) {
na_count <- sum(is.na(df[[var]]))
empty_count <- sum(df[[var]] == "", na.rm = TRUE)
cat(sprintf("%-15s: %d NA, %d vacíos (%.2f%%)\n",
var, na_count, empty_count, (na_count + empty_count)/nrow(df)*100))
}
cat("\n")
# Variables categóricas importantes
cat_vars <- c("Customer.Name", "Product.Name", "Category", "Sub.Category", "Region")
cat("Variables categóricas importantes:\n")
for(var in cat_vars) {
na_count <- sum(is.na(df[[var]]))
empty_count <- sum(df[[var]] == "", na.rm = TRUE)
whitespace_count <- sum(grepl("^\\s+$", df[[var]]), na.rm = TRUE)
cat(sprintf("%-15s: %d NA, %d vacíos, %d espacios (%.2f%%)\n",
var, na_count, empty_count, whitespace_count,
(na_count + empty_count + whitespace_count)/nrow(df)*100))
}
# Guardar resultados en archivo
write.csv(resultados, "validacion_campos_vacios.csv", row.names = FALSE)
cat("\nResultados guardados en 'validacion_campos_vacios.csv'\n")
# Visualización rápida de los resultados
if(any(resultados$Total_Vacios > 0)) {
library(ggplot2)
problematic <- resultados[resultados$Total_Vacios > 0, ]
problematic <- problematic[order(-problematic$Porcentaje_Total), ]
problematic$Columna <- factor(problematic$Columna,
levels = problematic$Columna[order(problematic$Porcentaje_Total)])
p <- ggplot(problematic, aes(x = Columna, y = Porcentaje_Total, fill = Tipo_Dato)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(title = "Porcentaje de Campos Vacíos por Columna",
x = "Columna",
y = "Porcentaje de Valores Vacíos (%)") +
theme_minimal() +
geom_text(aes(label = paste0(Porcentaje_Total, "%")),
hjust = -0.1, size = 3)
print(p)
ggsave("grafico_campos_vacios.png", plot = p, width = 10, height = 6)
cat("Gráfico guardado como 'grafico_campos_vacios.png'\n")
}
cat("\n=== VALIDACIÓN COMPLETADA ===\n")
View(resultados)
datos <-read.csv("Sample - Superstore.csv", sep = ",")
colSums(is.na(datos))
colSums(is.na(datos))
dataframeDatos <- subset(datos, select = -c(Row.ID, Order.ID, Customer.ID, Customer.Name, Country,
City, State, Postal.Code, Product.ID))
View(dataframeDatos)
View(dataframeDatos)
summary(datos)
str(datos)
View(dataframeDatos)
summary(dataframeDatos$Ship.Date)
summary(dataframeDatos$Ship.Mode)
summary(dataframeDatos$Ship.Date)
summary(dataframeDatos$Ship.Mode)
View(dataframeDatos)
head(dataframeDatos)
dataframeDatos$Order.Date <- as.Date(dataframeDatos$Order.Date, format = "%m/%d/%Y")
dataframeDatos$Ship.Date <- as.Date(dataframeDatos$Ship.Date, format = "%m/%d/%Y")
print(dataframeDatos$Order.Date)
summary(dataframeDatos$Order.Date)
summary(dataframeDatos$Ship.Mode)
head(dataframeDatos$Order.Date)
head(dataframeDatos$Ship.Date)
head(dataframeDatos$Ship.Date)
datos <-read.csv("Sample - Superstore.csv", sep = ",")
dataframeDatos <- subset(datos, select = -c(Row.ID, Order.ID, Customer.ID, Customer.Name, Country,
City, State, Postal.Code, Product.ID))
head(dataframeDatos)
summary(dataframeDatos$Ship.Date)
head(dataframeDatos$Ship.Date)
summary(dataframeDatos$Order.Date)
head(dataframeDatos$Order.Date)
summary(dataframeDatos$Order.Date)
head(dataframeDatos$Order.Date)
summary(dataframeDatos$Ship.Date)
head(dataframeDatos$Ship.Date)
dataframeDatos$Order.Date <- as.Date(dataframeDatos$Order.Date, format = "%m/%d/%Y")
dataframeDatos$Ship.Date <- as.Date(dataframeDatos$Ship.Date, format = "%m/%d/%Y")
head(dataframeDatos$Order.Date)
head(dataframeDatos$Ship.Date)
head(dataframeDatos$Order.Date)
View(dataframeDatos)
summary(dataframeDatos$Sales)
str(dataframeDatos$Sales)
str(dataframeDatos$Sales)
str(dataframeDatos$Sales, dataframeDatos$Quantity)
str(dataframeDatos$Sales, dataframeDatos$Quantity)
str(dataframeDatos$Sales,  dataframeDatos$Quantity)
class(dataframeDatos$Sales,  dataframeDatos$Quantity)
class(dataframeDatos$Sales)
class(dataframeDatos$Profit)
class(dataframeDatos$Quantity)
```{r}
class(dataframeDatos$Quantity)
class(dataframeDatos$Discount)
class(dataframeDatos$Quantity)
class(dataframeDatos$Discount)
class(dataframeDatos$Sales)
class(dataframeDatos$Profit)
class(dataframeDatos$Order.Date)
datos <-read.csv("Sample - Superstore.csv", sep = ",")
dataframeDatos <- subset(datos, select = -c(Row.ID, Order.ID, Customer.ID, Customer.Name, Country,
City, State, Postal.Code, Product.ID))
class(dataframeDatos$Order.Date)
summary(dataframeDatos$Order.Date)
head(dataframeDatos$Order.Date)
class(dataframeDatos$Ship.Date)
summary(dataframeDatos$Ship.Date)
head(dataframeDatos$Ship.Date)
dataframeDatos$Order.Date <- as.Date(dataframeDatos$Order.Date, format = "%m/%d/%Y")
class(dataframeDatos$Order.Date)
head(dataframeDatos$Order.Date)
class(dataframeDatos$Ship.Date)
head(dataframeDatos$Ship.Date)
dataframeDatos$Ship.Date <- as.Date(dataframeDatos$Ship.Date, format = "%m/%d/%Y")
class(dataframeDatos$Ship.Date)
head(dataframeDatos$Ship.Date)
dataframeDatos$Sales <- as.numeric(dataframeDatos$Sales)
dataframeDatos$Profit <- as.numeric(dataframeDatos$Profit)
dataframeDatos$Quantity <- as.numeric(dataframeDatos$Quantity)
dataframeDatos$Discount <- as.numeric(dataframeDatos$Discount)
class(dataframeDatos$Sales)
class(dataframeDatos$Profit)
class(dataframeDatos$Quantity)
class(dataframeDatos$Discount)
dataframeDatos$Sales <- as.numeric(dataframeDatos$Sales)
dataframeDatos$Profit <- as.numeric(dataframeDatos$Profit)
dataframeDatos$Quantity <- as.numeric(dataframeDatos$Quantity)
dataframeDatos$Discount <- as.numeric(dataframeDatos$Discount)
sum(duplicated(datos))
sum(duplicated(datos$Product.ID))
sum(duplicated(datos))
sum(duplicated(dataframeDatos))
colSums(duplicated(dataframeDatos))
colSums(duplicated(datos))
colSums(duplicated(datos$Row.ID))
sum(duplicated(datos$Row.ID))
summary(dataframeDatos$Discount)
summary(dataframeDatos$Sales)
summary(dataframeDatos$Quantity)
summary(dataframeDatos$Discount)
summary(dataframeDatos$Quantity)
datos <-read.csv("Sample - Superstore.csv", sep = ",")
dataframeDatos <- subset(datos, select = -c(Row.ID, Order.ID, Customer.ID, Customer.Name, Country,
City, State, Postal.Code, Product.ID))
class(dataframeDatos$Order.Date)
summary(dataframeDatos$Order.Date)
head(dataframeDatos$Order.Date)
class(dataframeDatos$Ship.Date)
summary(dataframeDatos$Ship.Date)
head(dataframeDatos$Ship.Date)
dataframeDatos$Order.Date <- as.Date(dataframeDatos$Order.Date, format = "%m/%d/%Y")
dataframeDatos$Ship.Date <- as.Date(dataframeDatos$Ship.Date, format = "%m/%d/%Y")
class(dataframeDatos$Quantity)
class(dataframeDatos$Discount)
class(dataframeDatos$Sales)
dataframeDatos$Sales <- as.numeric(dataframeDatos$Sales)
dataframeDatos$Profit <- as.numeric(dataframeDatos$Profit)
dataframeDatos$Quantity <- as.numeric(dataframeDatos$Quantity)
dataframeDatos$Discount <- as.numeric(dataframeDatos$Discount)
View(dataframeDatos)
dataframeDatos$RangoDescuento <- cut(
dataframeDatos$Discount,
breaks = c(-Inf, 0.10, 0.20, 0.50, Inf),
labels = c('0-10%', '10-20%', '20-50%', '>50%')
)
boxplot(Profit ~ RangoDescuento,
data = dataframeDatos,
main = 'Profit por rangos de descuento',
xlab = 'Rango de descuento',
ylab = 'Profit',
col = c('#a1d99b', '#74c476', '#31a354', '#006d2c'),
ylim = c(-2000, 2000))  # Ajusta según tus datos
View(dataframeDatos)
# Crear los rangos de descuento
dataframeDatos$RangoDescuento <- cut(
dataframeDatos$Discount,
breaks = c(-Inf, 0.10, 0.20, 0.50, Inf),
labels = c("0-10%", "10-20%", "20-50%", ">50%")
)
# Boxplot mejorado de Profit por rangos de descuento
boxplot(Profit ~ RangoDescuento,
data = dataframeDatos,
main = 'Profit por rangos de descuento',
xlab = 'Rango de descuento',
ylab = 'Profit',
col = c('#a1d99b', '#74c476', '#31a354', '#006d2c'),
border = "black",
notch = TRUE,
cex.main = 1.3,
cex.lab = 1.2,
cex.axis = 1,
outpch = 20,         # puntos más pequeños
outcex = 0.6,        # tamaño de outliers
outcol = "gray40",   # color más suave
lwd = 2              # grosor de líneas
)
# Boxplot mejorado de Profit por rangos de descuento
boxplot(Profit ~ RangoDescuento,
data = dataframeDatos,
main = 'Profit por rangos de descuento',
xlab = 'Rango de descuento',
ylab = 'Profit',
col = c('#a1d99b', '#74c476', '#31a354', '#006d2c'),
border = "black",
notch = TRUE,
cex.main = 1.3,
cex.lab = 1.2,
cex.axis = 1,
outpch = 20,         # puntos más pequeños
outcex = 0.6,        # tamaño de outliers
outcol = "gray40",   # color más suave
lwd = 2              # grosor de líneas
)
# Boxplot mejorado de Profit por rangos de descuento
boxplot(Sales ~ RangoDescuento,
data = dataframeDatos,
main = 'Profit por rangos de descuento',
xlab = 'Rango de descuento',
ylab = 'Profit',
col = c('#a1d99b', '#74c476', '#31a354', '#006d2c'),
border = "black",
notch = TRUE,
cex.main = 1.3,
cex.lab = 1.2,
cex.axis = 1,
outpch = 20,         # puntos más pequeños
outcex = 0.6,        # tamaño de outliers
outcol = "gray40",   # color más suave
lwd = 2              # grosor de líneas
)
# Boxplot mejorado de Profit por rangos de descuento
boxplot(Sales ~ RangoDescuento,
data = dataframeDatos,
main = 'Profit por rangos de descuento',
xlab = 'Rango de descuento',
ylab = 'Profit',
col = c('#a1d99b', '#74c476', '#31a354', '#006d2c'),
border = "black",
notch = TRUE,
cex.main = 1.3,
cex.lab = 1.2,
cex.axis = 1,
outpch = 20,         # puntos más pequeños
outcex = 0.6,        # tamaño de outliers
outcol = "gray40",   # color más suave
lwd = 2,              # grosor de línea
outline = FALSE
)
# Boxplot mejorado de Profit por rangos de descuento
boxplot(Sales ~ RangoDescuento,
data = dataframeDatos,
main = 'Profit por rangos de descuento',
xlab = 'Rango de descuento',
ylab = 'Profit',
col = c('#a1d99b', '#74c476', '#31a354', '#006d2c'),
border = "black",
notch = TRUE,
cex.main = 1.3,
cex.lab = 1.2,
cex.axis = 1,
outline = FALSE
)
# Boxplot mejorado de Profit por rangos de descuento
boxplot(Sales ~ RangoDescuento,
data = dataframeDatos,
main = 'Profit por rangos de descuento',
xlab = 'Rango de descuento',
ylab = 'Profit',
col = c('#a1d99b', '#74c476', '#31a354', '#006d2c'),
border = "black",
notch = TRUE,
cex.main = 1.3,
cex.lab = 1.2,
cex.axis = 1,
outpch = 20,         # puntos más pequeños
outcex = 0.6,        # tamaño de outliers
outcol = "gray40",   # color más suave
lwd = 2,              # grosor de línea
outline = FALSE
)
# Boxplot mejorado de Profit por rangos de descuento
boxplot(Sales ~ RangoDescuento,
data = dataframeDatos,
main = 'Profit por rangos de descuento',
xlab = 'Rango de descuento',
ylab = 'Profit',
col = c('#a1d99b', '#74c476', '#31a354', '#006d2c'),
border = "black",
notch = TRUE,
outline = FALSE
)
# Boxplot mejorado de Profit por rangos de descuento
boxplot(Sales ~ RangoDescuento,
data = dataframeDatos,
main = 'Profit por rangos de descuento',
xlab = 'Rango de descuento',
ylab = 'Profit',
col = c('#a1d99b', '#74c476', '#31a354', '#006d2c'),
border = "black",
outline = FALSE
)
# CON outliers (escala grande)
boxplot(Profit ~ RangoDescuento, data = dataframeDatos,
ylim = c(-6000, 7000))  # Caja se ve pequeña
# SIN outliers pero MANTENIENDO la escala original
boxplot(Profit ~ RangoDescuento, data = dataframeDatos,
outline = FALSE,
ylim = c(-6000, 7000))  # Caja sigue viéndose pequeña
# SIN outliers y dejando que R reescale
boxplot(Profit ~ RangoDescuento, data = dataframeDatos,
outline = FALSE)  # Ahora la caja se ve GRANDE
dataframeDatos$RangoDescuento <- cut(
dataframeDatos$Discount,
breaks = c(-Inf, 0.10, 0.20, 0.50, Inf),
labels = c('0-10%', '10-20%', '20-50%', '>50%'))
boxplot(Profit ~ RangoDescuento,
data = dataframeDatos,
main = 'Profit por rangos de descuento',
xlab = 'Rango de descuento',
ylab = 'Profit',
col = c('#a1d99b', '#74c476', '#31a354', '#006d2c'),
outline = FALSE)  # No grafica los outliers
dataframeDatos %>%
mutate(RangoDescuento = cut(
Discount,
breaks = c(-Inf, 0.10, 0.20, 0.50, Inf),
labels = c("0-10%", "10-20%", "20-50%", ">50%")
)) %>%
group_by(RangoDescuento) %>%
summarise(ProfitPromedio = mean(Profit, na.rm = TRUE)) %>%
ggplot(aes(x = RangoDescuento, y = ProfitPromedio)) +
geom_col(fill = "#238b45") +
labs(title = "Profit promedio por rango de descuento")
library(dplyr)
dataframeDatos %>%
mutate(RangoDescuento = cut(
Discount,
breaks = c(-Inf, 0.10, 0.20, 0.50, Inf),
labels = c("0-10%", "10-20%", "20-50%", ">50%")
)) %>%
group_by(RangoDescuento) %>%
summarise(ProfitPromedio = mean(Profit, na.rm = TRUE)) %>%
ggplot(aes(x = RangoDescuento, y = ProfitPromedio)) +
geom_col(fill = "#238b45") +
labs(title = "Profit promedio por rango de descuento")
library(ggplot2)
dataframeDatos %>%
mutate(RangoDescuento = cut(
Discount,
breaks = c(-Inf, 0.10, 0.20, 0.50, Inf),
labels = c("0-10%", "10-20%", "20-50%", ">50%")
)) %>%
group_by(RangoDescuento) %>%
summarise(ProfitPromedio = mean(Profit, na.rm = TRUE)) %>%
ggplot(aes(x = RangoDescuento, y = ProfitPromedio)) +
geom_col(fill = "#238b45") +
labs(title = "Profit promedio por rango de descuento")
shapiro.test(dataframeDatos$Sales[dataframeDatos$Category == "Furniture"])
shapiro.test(dataframeDatos$Sales[dataframeDatos$Category == "Office Supplies"])
shapiro.test(dataframeDatos$Sales[dataframeDatos$Category == "Furniture"])
shapiro.test(dataframeDatos$Sales[dataframeDatos$Category == "Office Supplies"])
shapiro.test(dataframeDatos$Sales[dataframeDatos$Category == "Technology"])
shapiro.test(dataframeDatos$Sales[dataframeDatos$Category == "Furniture"])
muestra <- sample(dataframeDatos$Sales[dataframeDatos$Category == "Office Supplies"], 5000)
shapiro.test(muestra)
shapiro.test(dataframeDatos$Sales[dataframeDatos$Sub.Category == "Chairs"])
shapiro.test(dataframeDatos$Sales[dataframeDatos$Sub.Category == "Phones"])
shapiro.test(dataframeDatos$Sales[dataframeDatos$Sub.Category == "Binders"])
shapiro.test(dataframeDatos$Sales[dataframeDatos$Sub.Category == "Storage"])
medianProfit <- median(dataframeDatos$Profit)
shapiro.test(dataframeDatos$Profit[dataframeDatos$Profit >= medianProfit])  # más rentables
shapiro.test(dataframeDatos$Profit[dataframeDatos$Profit < medianProfit])   # menos rentables
shapiro.test(dataframeDatos$Discount)
shapiro.test(dataframeDatos$Profit)
muestraDiscount <- sample(dataframeDatos$Discount, 5000)
muestraProfit <- sample(dataframeDatos$Profit, 5000)
shapiro.test(muestraDiscount)
shapiro.test(muestraProfit)
shapiro.test(muestraDiscount)
shapiro.test(muestraProfit)
setwd("~/GitHub/ExamenFinal-ExploracionDeDatos")
datos <- read.csv("Product-Sales-Region.csv")
View(datos)
datos <- na.omit(datos)
View(datos)
datos <- read.csv("Product-Sales-Region.csv")
str(datos)
colSums(datos$Promotion)
colSums(is.na(datos$Promotion))
sum(is.na(datos$Promotion))
summary(is.na(datos$Promotion))
library(ggplot2)
ggplot(datos, aes(x = variable)) + geom_histogram()
pca_result <- prcomp(datos, scale. = TRUE)
